# CVE & Vulnerability Lookup Lambda

Fetches CVE data from **NVD (NIST)** and **OSV**; optional AI "should I be worried?" analysis.

## Free APIs (no keys required)

- **NVD 2.0**: https://services.nvd.nist.gov/rest/json/cves/2.0 — 5 req/30s without key
- **OSV**: https://api.osv.dev — no key, no strict rate limit

## Optional: NVD API key

For higher NVD rate limits (50 req/30s), request a free key:

https://nvd.nist.gov/developers/request-an-api-key

Set `NVD_API_KEY` in the Lambda environment (via Terraform `nvd_api_key`).

## Optional: AI analysis

When `analyze: true`, the Lambda calls OpenAI (same key as Security Advisor) and returns a short verdict, one-liner, factors, and recommendation. This uses the **advisor** meter (API Access subscription).

## Request

- **CVE ID**: `{ "mode": "cve", "cveId": "CVE-2024-3400", "analyze": false }`
- **Package (OSV)**: `{ "mode": "package", "ecosystem": "npm", "package": "lodash", "version": "4.17.21", "analyze": false }`

## Metering

- Fetch (NVD/OSV): **remote** (1 call)
- AI analysis: **advisor** (1 call)

## Dependencies

None. Uses `fetch` (Node 18+) and AWS SDK (Lambda runtime).
